async function toggleDetails(coinId, index) {
    const detailsRow = document.getElementById(`details-${coinId}`);
    const isExpanded = detailsRow.classList.contains('expanded');
    
    // Close all other expanded rows
    document.querySelectorAll('.expandable-row.expanded').forEach(row => {
        if (row.id !== `details-${coinId}`) {
            row.classList.remove('expanded');
        }
    });

    if (!isExpanded) {
        detailsRow.classList.add('expanded');
        const detailsContent = document.getElementById(`details-content-${coinId}`);
        
        try {
            const response = await fetch(
                `/.netlify/functions/fetchCrypto?coinId=${coinId}`
            );
            const result = await response.json();
            const data = result.data;
            
            // Rest of the display code remains the same
            detailsContent.innerHTML = `
                <div class="detail-list">
                    // ... existing detail display code ...
                </div>
            `;
        } catch (error) {
            console.error('Error fetching coin details:', error);
            detailsContent.innerHTML = 'Error loading details. Please try again.';
        }
    } else {
        detailsRow.classList.remove('expanded');
    }
}
